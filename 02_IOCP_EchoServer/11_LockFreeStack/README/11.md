# IOCP Echo Server 11 - 락 프리 스택 적용
## 목적
멀티 스레딩 감각을 기르기 위함
* SRWLock으로 접근되던 모든 스택 자료구조를 락 프리 스택으로 교체
  * AcceptEx 대기 세션 인덱스 스택
  * Session 해제 인덱스 스택
* 메모리 풀을 모두 락프리 메모리 풀로 교체

## 작업 내용
진짜 교체 작업
* 말 그대로 교체하면 됨
* 코드의 수정 사항은 많지 않았음

## 작업 결과
오히려 TPS가 떨어졌음
* 성능이 떨어짐
* SendTPS 1만 정도 떨어짐

스핀락과 비교해서
* 스핀락 - 퀀텀 시간 내에 자원을 획득하면 이득
* 락프리 - 먼저 대기하고 있던 것이 블록, 혹은 대기 상태에 빠져서 늦게 출발한 애가 앞지르면 이득

사실 스택과 오브젝트 풀의 작업은 굉장히 짧음
* 그렇기 때문에 스핀락이 의도한 대로 퀀텀 시간 내에 자원을 잘 획득하고 있었다고 추측
* 따라서 락프리 자료구조가 더 안좋은 결과를 보이지 않았나 싶음
* 그러나 멀티 스레딩 디버그 감각을 키우기 위해 락프리 자료구조를 사용할 것임